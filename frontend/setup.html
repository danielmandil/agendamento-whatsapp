<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configure sua Barbearia - Sistema Completo</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto max-w-4xl p-4">
        <!-- Header com progresso -->
        <div id="headerSection" class="text-center py-8">
            <h1 class="text-3xl font-bold text-gray-800">
                ‚úÇÔ∏è Configure sua Barbearia
            </h1>
            <p class="text-gray-600 mt-2">
                Setup completo em 6 passos simples
            </p>
            
            <!-- Barra de progresso -->
            <div class="mt-4 w-full bg-gray-200 rounded-full h-2">
                <div id="progressBar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p class="text-sm text-gray-500 mt-1">
                <span id="currentStep">1</span> de 6 - <span id="stepDescription">Informa√ß√µes b√°sicas</span>
            </p>
        </div>

        <!-- Formul√°rio com steps -->
        <div id="formSection" class="bg-white rounded-lg shadow-md overflow-hidden">
            <form id="setupForm" class="space-y-0">
                
                <!-- Step 1: Informa√ß√µes B√°sicas -->
                <div class="step-content p-6" data-step="1">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">
                        1Ô∏è‚É£ Informa√ß√µes da sua Barbearia
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">
                                Nome da Barbearia *
                            </label>
                            <input 
                                type="text" 
                                id="businessName"
                                placeholder="Barbearia Estilo Masculino"
                                class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                                required
                            >
                            <p class="text-xs text-gray-500 mt-1">Aparecer√° no link e nas mensagens</p>
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">
                                WhatsApp Business *
                            </label>
                            <input 
                                type="tel" 
                                id="whatsapp"
                                placeholder="31999887766"
                                class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                                required
                            >
                            <p class="text-xs text-gray-500 mt-1">Apenas n√∫meros, com DDD</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 font-medium mb-2">
                            Endere√ßo (opcional)
                        </label>
                        <input 
                            type="text" 
                            id="address"
                            placeholder="Rua das Flores, 123 - Centro, Belo Horizonte"
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"
                        >
                        <p class="text-xs text-gray-500 mt-1">Aparecer√° nas confirma√ß√µes de agendamento</p>
                    </div>
                </div>

                <!-- Step 2: Dias de Funcionamento -->
                <div class="step-content p-6 hidden" data-step="2">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">
                        2Ô∏è‚É£ Quando sua barbearia funciona?
                    </h2>
                    
                    <p class="text-gray-600 mb-4">
                        Marque os dias em que voc√™ atende clientes
                    </p>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                        <label class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" id="day-1" class="day-checkbox" value="1" checked>
                            <span class="font-medium">Segunda</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" id="day-2" class="day-checkbox" value="2" checked>
                            <span class="font-medium">Ter√ßa</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" id="day-3" class="day-checkbox" value="3" checked>
                            <span class="font-medium">Quarta</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" id="day-4" class="day-checkbox" value="4" checked>
                            <span class="font-medium">Quinta</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" id="day-5" class="day-checkbox" value="5" checked>
                            <span class="font-medium">Sexta</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" id="day-6" class="day-checkbox" value="6" checked>
                            <span class="font-medium">S√°bado</span>
                        </label>
                        <label class="flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                            <input type="checkbox" id="day-0" class="day-checkbox" value="0">
                            <span class="font-medium">Domingo</span>
                        </label>
                    </div>
                    
                    <!-- Configura√ß√£o r√°pida -->
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <p class="text-sm font-medium text-blue-800 mb-2">‚ö° Configura√ß√£o r√°pida:</p>
                        <div class="space-x-2">
                            <button type="button" onclick="setWorkingDays([1,2,3,4,5,6])" class="text-xs px-3 py-1 bg-blue-500 text-white rounded">Seg-S√°b</button>
                            <button type="button" onclick="setWorkingDays([1,2,3,4,5])" class="text-xs px-3 py-1 bg-blue-500 text-white rounded">Seg-Sex</button>
                            <button type="button" onclick="setWorkingDays([2,3,4,5,6])" class="text-xs px-3 py-1 bg-blue-500 text-white rounded">Ter-S√°b</button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Hor√°rios -->
                <div class="step-content p-6 hidden" data-step="3">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">
                        3Ô∏è‚É£ Hor√°rios de funcionamento
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">
                                üåÖ Hora de abertura
                            </label>
                            <select id="openTime" class="w-full px-4 py-2 border rounded-lg">
                                <option value="7">07:00</option>
                                <option value="8" selected>08:00</option>
                                <option value="9">09:00</option>
                                <option value="10">10:00</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">
                                üåÜ Hora de fechamento
                            </label>
                            <select id="closeTime" class="w-full px-4 py-2 border rounded-lg">
                                <option value="17">17:00</option>
                                <option value="18" selected>18:00</option>
                                <option value="19">19:00</option>
                                <option value="20">20:00</option>
                                <option value="21">21:00</option>
                                <option value="22">22:00</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Hor√°rio de Almo√ßo -->
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <label class="flex items-center space-x-2 mb-3">
                            <input type="checkbox" id="hasLunchBreak" onchange="toggleLunchBreak()">
                            <span class="font-medium">üçΩÔ∏è Configurar pausa para almo√ßo</span>
                        </label>
                        
                        <div id="lunchBreakConfig" class="hidden grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">In√≠cio da pausa</label>
                                <select id="lunchStart" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="11:30">11:30</option>
                                    <option value="12:00" selected>12:00</option>
                                    <option value="12:30">12:30</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm text-gray-600 mb-1">Fim da pausa</label>
                                <select id="lunchEnd" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="13:00" selected>13:00</option>
                                    <option value="13:30">13:30</option>
                                    <option value="14:00">14:00</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Servi√ßos -->
                <div class="step-content p-6 hidden" data-step="4">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">
                        4Ô∏è‚É£ Seus servi√ßos e pre√ßos
                    </h2>
                    
                    <p class="text-gray-600 mb-4">
                        Configure os servi√ßos que voc√™ oferece, quanto tempo demora cada um e o pre√ßo
                    </p>
                    
                    <div id="servicesList" class="space-y-4 mb-6">
                        <!-- Servi√ßo padr√£o - Corte -->
                        <div class="service-item p-4 border-2 border-blue-200 rounded-lg bg-blue-50">
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‚úÇÔ∏è Servi√ßo</label>
                                    <input 
                                        type="text" 
                                        placeholder="Corte masculino"
                                        class="service-name w-full px-3 py-2 border rounded"
                                        value="Corte masculino"
                                    >
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‚è±Ô∏è Tempo</label>
                                    <select class="service-duration w-full px-3 py-2 border rounded">
                                        <option value="20">20 min</option>
                                        <option value="30" selected>30 min</option>
                                        <option value="40">40 min</option>
                                        <option value="45">45 min</option>
                                        <option value="60">1 hora</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">üí∞ Pre√ßo</label>
                                    <input 
                                        type="number" 
                                        placeholder="35.00"
                                        class="service-price w-full px-3 py-2 border rounded"
                                        step="0.01"
                                        value="35.00"
                                    >
                                </div>
                                <div class="flex items-end">
                                    <button 
                                        type="button"
                                        onclick="removeService(this)"
                                        class="text-red-600 hover:text-red-800 text-sm"
                                        disabled
                                    >
                                        üóëÔ∏è Remover
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Bot√µes para adicionar servi√ßos comuns -->
                    <div class="mb-4">
                        <p class="text-sm font-medium text-gray-700 mb-2">Adicionar servi√ßos comuns:</p>
                        <div class="flex flex-wrap gap-2">
                            <button type="button" onclick="addCommonService('Barba', 20, 25)" class="text-xs px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded">üßî Barba</button>
                            <button type="button" onclick="addCommonService('Sobrancelha', 15, 15)" class="text-xs px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded">üëÅÔ∏è Sobrancelha</button>
                            <button type="button" onclick="addCommonService('Corte + Barba', 45, 55)" class="text-xs px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded">‚úÇÔ∏èüßî Corte + Barba</button>
                            <button type="button" onclick="addCommonService('Degrad√™', 40, 40)" class="text-xs px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded">‚ú® Degrad√™</button>
                        </div>
                    </div>
                    
                    <button 
                        type="button"
                        onclick="addService()"
                        class="w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-400 hover:text-blue-600"
                    >
                        ‚ûï Adicionar outro servi√ßo personalizado
                    </button>
                </div>

                <!-- Step 5: Configura√ß√µes Avan√ßadas -->
                <div class="step-content p-6 hidden" data-step="5">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">
                        5Ô∏è‚É£ Configura√ß√µes de agendamento
                    </h2>
                    
                    <div class="space-y-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">
                                ‚è∞ Com quanto tempo de anteced√™ncia podem agendar?
                            </label>
                            <select id="minAdvanceTime" class="w-full px-4 py-2 border rounded-lg">
                                <option value="0">Podem agendar na hora</option>
                                <option value="1">Pelo menos 1 hora antes</option>
                                <option value="2" selected>Pelo menos 2 horas antes</option>
                                <option value="24">Pelo menos 1 dia antes</option>
                            </select>
                            <p class="text-xs text-gray-500 mt-1">Evita agendamentos de √∫ltima hora</p>
                        </div>
                        
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">
                                üî¢ Quantos clientes por dia no m√°ximo?
                            </label>
                            <input 
                                type="number" 
                                id="maxBookingsPerDay"
                                placeholder="0 = sem limite"
                                class="w-full px-4 py-2 border rounded-lg"
                                min="0"
                                value="0"
                            >
                            <p class="text-xs text-gray-500 mt-1">0 = sem limite (recomendado)</p>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-medium mb-2">
                                ‚è≥ Intervalo entre atendimentos
                            </label>
                            <select id="bufferTime" class="w-full px-4 py-2 border rounded-lg">
                                <option value="0">Sem intervalo</option>
                                <option value="5">5 minutos</option>
                                <option value="10" selected>10 minutos</option>
                                <option value="15">15 minutos</option>
                            </select>
                            <p class="text-xs text-gray-500 mt-1">Tempo para limpeza entre clientes</p>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Finaliza√ß√£o -->
                <div class="step-content p-6 hidden" data-step="6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">
                        6Ô∏è‚É£ Quase pronto! üéâ
                    </h2>
                    
                    <div class="bg-green-50 p-6 rounded-lg mb-6">
                        <h3 class="font-semibold text-green-800 mb-2">Resumo da sua configura√ß√£o:</h3>
                        <div id="configSummary" class="text-sm text-green-700 space-y-1">
                            <!-- Ser√° preenchido via JavaScript -->
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-blue-800 mb-2">üì± Como funciona:</h3>
                        <ol class="text-sm text-blue-700 space-y-1 list-decimal list-inside">
                            <li>Voc√™ receber√° um link √∫nico para sua barbearia</li>
                            <li>Compartilhe esse link com seus clientes</li>
                            <li>Eles escolhem o servi√ßo, data e hor√°rio</li>
                            <li>Confirma√ß√£o autom√°tica via WhatsApp</li>
                            <li>Voc√™ acessa o painel para ver todos os agendamentos</li>
                        </ol>
                    </div>
                </div>
            </form>
        </div>

        <!-- Navega√ß√£o -->
        <div id="navigationSection" class="flex justify-between mt-6">
            <button 
                type="button"
                id="prevBtn"
                onclick="changeStep(-1)"
                class="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"
                disabled
            >
                ‚Üê Anterior
            </button>
            
            <button 
                type="button"
                id="nextBtn"
                onclick="changeStep(1)"
                class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
            >
                Pr√≥ximo ‚Üí
            </button>
            
            <button 
                type="button"
                id="submitBtn"
                onclick="submitForm()"
                class="hidden px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600"
            >
                üöÄ Criar Sistema
            </button>
        </div>

        <!-- Resultado -->
        <div id="result" class="hidden mt-6 bg-white rounded-lg shadow-md p-6">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-2xl">‚úÖ</span>
                </div>
                <h3 class="text-xl font-semibold text-gray-800 mb-2">
                    Sistema criado com sucesso!
                </h3>
                <p class="text-gray-600">
                    Sua barbearia j√° est√° pronta para receber agendamentos online
                </p>
            </div>
            
            <div class="bg-gray-50 p-4 rounded-lg mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    üîó Link para seus clientes:
                </label>
                <div class="bg-white p-3 rounded border">
                    <code id="generatedLink" class="text-blue-600 break-all"></code>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <button 
                    onclick="copyLink()"
                    class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600"
                >
                    üìã Copiar Link
                </button>
                <a 
                    id="panelLink"
                    href="#"
                    target="_blank"
                    class="w-full bg-purple-500 text-white py-2 px-4 rounded-lg hover:bg-purple-600 text-center"
                >
                    üìä Abrir Painel
                </a>
                <button 
                    onclick="testBooking()"
                    class="w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600"
                >
                    üß™ Testar Agendamento
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let totalSteps = 6;
        let blockedDates = [];

        // Controle de steps
        function changeStep(direction) {
            if (direction === 1 && !validateCurrentStep()) {
                return;
            }
            
            const newStep = currentStep + direction;
            if (newStep < 1 || newStep > totalSteps) return;
            
            // Esconder step atual
            document.querySelector(`[data-step="${currentStep}"]`).classList.add('hidden');
            
            // Mostrar novo step
            document.querySelector(`[data-step="${newStep}"]`).classList.remove('hidden');
            
            currentStep = newStep;
            updateUI();
            
            if (currentStep === 6) {
                updateConfigSummary();
            }
        }

        function updateUI() {
            // Atualizar progresso
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentStep').textContent = currentStep;
            
            // Atualizar descri√ß√µes
            const descriptions = [
                'Informa√ß√µes b√°sicas',
                'Dias de funcionamento', 
                'Hor√°rios',
                'Servi√ßos e pre√ßos',
                'Configura√ß√µes',
                'Finalizar'
            ];
            document.getElementById('stepDescription').textContent = descriptions[currentStep - 1];
            
            // Controlar bot√µes
            document.getElementById('prevBtn').disabled = currentStep === 1;
            document.getElementById('nextBtn').style.display = currentStep === totalSteps ? 'none' : 'block';
            document.getElementById('submitBtn').style.display = currentStep === totalSteps ? 'block' : 'none';
        }

        function validateCurrentStep() {
            switch(currentStep) {
                case 1:
                    const name = document.getElementById('businessName').value.trim();
                    const whatsapp = document.getElementById('whatsapp').value.trim();
                    if (!name || !whatsapp) {
                        alert('Preencha o nome da barbearia e o WhatsApp');
                        return false;
                    }
                    break;
                case 2:
                    const selectedDays = document.querySelectorAll('.day-checkbox:checked');
                    if (selectedDays.length === 0) {
                        alert('Selecione pelo menos um dia de funcionamento');
                        return false;
                    }
                    break;
                case 4:
                    const services = collectServices();
                    if (services.length === 0) {
                        alert('Configure pelo menos um servi√ßo');
                        return false;
                    }
                    break;
            }
            return true;
        }

        // Toggle configura√ß√£o de almo√ßo
        function toggleLunchBreak() {
            const checkbox = document.getElementById('hasLunchBreak');
            const config = document.getElementById('lunchBreakConfig');
            config.classList.toggle('hidden', !checkbox.checked);
        }

        // Configura√ß√£o r√°pida de dias
        function setWorkingDays(days) {
            document.querySelectorAll('.day-checkbox').forEach(cb => cb.checked = false);
            days.forEach(day => {
                document.getElementById(`day-${day}`).checked = true;
            });
        }

        // Adicionar servi√ßos
        function addCommonService(name, duration, price) {
            const servicesList = document.getElementById('servicesList');
            const newService = createServiceElement(name, duration, price);
            servicesList.appendChild(newService);
        }

        function addService() {
            const servicesList = document.getElementById('servicesList');
            const newService = createServiceElement('', 30, 0);
            servicesList.appendChild(newService);
        }

        function createServiceElement(name = '', duration = 30, price = 0) {
            const newService = document.createElement('div');
            newService.className = 'service-item p-4 border rounded-lg';
            newService.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‚úÇÔ∏è Servi√ßo</label>
                        <input 
                            type="text" 
                            placeholder="Nome do servi√ßo"
                            class="service-name w-full px-3 py-2 border rounded"
                            value="${name}"
                        >
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‚è±Ô∏è Tempo</label>
                        <select class="service-duration w-full px-3 py-2 border rounded">
                            <option value="15" ${duration === 15 ? 'selected' : ''}>15 min</option>
                            <option value="20" ${duration === 20 ? 'selected' : ''}>20 min</option>
                            <option value="30" ${duration === 30 ? 'selected' : ''}>30 min</option>
                            <option value="40" ${duration === 40 ? 'selected' : ''}>40 min</option>
                            <option value="45" ${duration === 45 ? 'selected' : ''}>45 min</option>
                            <option value="60" ${duration === 60 ? 'selected' : ''}>1 hora</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">üí∞ Pre√ßo</label>
                        <input 
                            type="number" 
                            placeholder="0.00"
                            class="service-price w-full px-3 py-2 border rounded"
                            step="0.01"
                            value="${price}"
                        >
                    </div>
                    <div class="flex items-end">
                        <button 
                            type="button"
                            onclick="removeService(this)"
                            class="text-red-600 hover:text-red-800 text-sm"
                        >
                            üóëÔ∏è Remover
                        </button>
                    </div>
                </div>
            `;
            return newService;
        }

        function removeService(button) {
            const serviceItem = button.closest('.service-item');
            const servicesList = document.getElementById('servicesList');
            if (servicesList.children.length > 1) {
                serviceItem.remove();
            } else {
                alert('Voc√™ precisa ter pelo menos um servi√ßo!');
            }
        }

        // Coletar dados
        function collectServices() {
            const services = [];
            document.querySelectorAll('.service-item').forEach(item => {
                const name = item.querySelector('.service-name').value.trim();
                const duration = parseInt(item.querySelector('.service-duration').value);
                const price = parseFloat(item.querySelector('.service-price').value) || 0;
                
                if (name) {
                    services.push({ name, duration, price });
                }
            });
            return services;
        }

        function collectWorkingDays() {
            const days = [];
            document.querySelectorAll('.day-checkbox:checked').forEach(checkbox => {
                days.push(parseInt(checkbox.value));
            });
            return days;
        }

        function updateConfigSummary() {
            const businessName = document.getElementById('businessName').value;
            const workingDays = collectWorkingDays();
            const openTime = document.getElementById('openTime').value;
            const closeTime = document.getElementById('closeTime').value;
            const services = collectServices();
            
            const dayNames = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
            const workingDaysText = workingDays.map(d => dayNames[d]).join(', ');
            
            const summary = `
                <div><strong>Barbearia:</strong> ${businessName}</div>
                <div><strong>Funcionamento:</strong> ${workingDaysText} das ${openTime}h √†s ${closeTime}h</div>
                <div><strong>Servi√ßos:</strong> ${services.length} configurados</div>
                <div><strong>Principal:</strong> ${services[0]?.name} (${services[0]?.duration}min - R$ ${services[0]?.price})</div>
            `;
            
            document.getElementById('configSummary').innerHTML = summary;
        }

        // Submiss√£o do formul√°rio - VERS√ÉO CORRIGIDA
        async function submitForm() {
            console.log('üöÄ INICIANDO submitForm()');
            
            const services = collectServices();
            const workingDays = collectWorkingDays();
            
            console.log('üìä Services coletados:', services);
            console.log('üìÖ Working days coletados:', workingDays);
            
            const formData = {
                businessName: document.getElementById('businessName').value.trim(),
                whatsapp: document.getElementById('whatsapp').value.trim(),
                address: document.getElementById('address').value.trim(),
                openTime: parseInt(document.getElementById('openTime').value),
                closeTime: parseInt(document.getElementById('closeTime').value),
                bufferTime: parseInt(document.getElementById('bufferTime').value),
                workingDays: workingDays,
                services: services,
                minAdvanceTime: parseInt(document.getElementById('minAdvanceTime').value),
                maxBookingsPerDay: parseInt(document.getElementById('maxBookingsPerDay').value) || 0,
                hasLunchBreak: document.getElementById('hasLunchBreak').checked,
                lunchStart: document.getElementById('hasLunchBreak').checked ? document.getElementById('lunchStart').value : null,
                lunchEnd: document.getElementById('hasLunchBreak').checked ? document.getElementById('lunchEnd').value : null
            };
            
            console.log('üì¶ FormData montado:', formData);
            
            try {
                console.log('üåê Fazendo fetch para /api/barbers...');
                
                const response = await fetch('/api/barbers', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                console.log('üì• Resposta recebida - Status:', response.status);
                console.log('üì• Resposta recebida - OK:', response.ok);

                const result = await response.json();
                console.log('üìã Resultado parseado:', result);

                if (result.success) {
                    console.log('‚úÖ SUCESSO! Dados:', result.data);
                    console.log('üîó Link gerado:', result.data.bookingUrl);
                    
                    // Atualizar elementos de resultado
                    document.getElementById('generatedLink').textContent = result.data.bookingUrl;
                    document.getElementById('panelLink').href = `/painel.html?slug=${result.data.slug}`;
                    
                    // CORRIGIDO: Mostrar resultado e esconder formul√°rio corretamente
                    document.getElementById('result').classList.remove('hidden');
                    
                    // Esconder se√ß√µes espec√≠ficas (n√£o o container inteiro)
                    document.getElementById('headerSection').style.display = 'none';
                    document.getElementById('formSection').style.display = 'none';
                    document.getElementById('navigationSection').style.display = 'none';
                    
                    console.log('üéØ Interface atualizada!');
                    
                    // Scroll para o resultado
                    document.getElementById('result').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                    
                    // Atualizar t√≠tulo da p√°gina
                    document.title = `Sistema Criado - ${result.data.businessName}`;
                    
                } else {
                    console.error('‚ùå Erro do servidor:', result.error);
                    alert('Erro ao criar sistema: ' + (result.error || 'Erro desconhecido'));
                }
            } catch (error) {
                console.error('üí• Erro na requisi√ß√£o:', error);
                alert('Erro ao conectar com o servidor.');
            }
        }

        // Fun√ß√µes auxiliares
        function copyLink() {
            const link = document.getElementById('generatedLink').textContent;
            navigator.clipboard.writeText(link);
            alert('Link copiado! üìã');
        }

        function testBooking() {
            const link = document.getElementById('generatedLink').textContent;
            window.open(link, '_blank');
        }

        // Inicializa√ß√£o
        updateUI();
    </script>
</body>
</html>